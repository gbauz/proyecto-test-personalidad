datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
 id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  name      String
  roleId    Int
  role      Role     @relation(fields: [roleId], references: [id])
  createdAt DateTime @default(now())
  usuarioTests  UsuarioTest[]
}

model Role {
  id    Int    @id @default(autoincrement())
  name  String @unique
  users User[]
}

model UsuarioTest {
  id         Int               @id @default(autoincrement())
  idUsuario  Int
  tipoTestId Int
  codigo     String

  usuario    User           @relation(fields: [idUsuario], references: [id])
  tipoTest   TipoTest          @relation(fields: [tipoTestId], references: [id])
  respuestas RespuestasUsuarioTest[]
  resultados ResultadosDeTest[]
}


model TipoTest {
  id          Int               @id @default(autoincrement())
  nombre      String
  categorias  CategoriaDePreguntas[]
  usuarioTests UsuarioTest[]
}


model CategoriaDePreguntas {
  id          Int               @id @default(autoincrement())
  nombre      String
  orden       Int
  tipoTestId  Int
  tipoTest    TipoTest          @relation(fields: [tipoTestId], references: [id])
  preguntas   Pregunta[]
  respuestasUsuario  RespuestasUsuarioTest[]
}

model Pregunta {
  id                 Int               @id @default(autoincrement())
  pregunta           String
  categoriaPreguntasId Int
  categoriaPreguntas CategoriaDePreguntas @relation(fields: [categoriaPreguntasId], references: [id])
  respuestasUsuario  RespuestasUsuarioTest[]
}


model Respuesta {
  id       Int    @id @default(autoincrement())
  nombre   String
  puntaje  Int
  respuestasUsuario RespuestasUsuarioTest[]
}



model RespuestasUsuarioTest {
  id             Int         @id @default(autoincrement())
  idUsuarioTest  Int
  idRespuesta    Int
  idPregunta     Int
  idCategoria    Int

  usuarioTest    UsuarioTest @relation(fields: [idUsuarioTest], references: [id])
  respuesta      Respuesta   @relation(fields: [idRespuesta], references: [id])
  pregunta       Pregunta    @relation(fields: [idPregunta], references: [id])
  categoria      CategoriaDePreguntas @relation(fields: [idCategoria], references: [id])
}


model Dicotomia {
  id          Int               @id @default(autoincrement())
  nombre      String
  descripcion String?
  resultados  ResultadosDeTest[]
}

model ResultadosDeTest {
  id           Int           @id @default(autoincrement())
  idDicotomia  Int
  idUsuarioTest Int

  dicotomia    Dicotomia      @relation(fields: [idDicotomia], references: [id])
  usuarioTest  UsuarioTest    @relation(fields: [idUsuarioTest], references: [id])
}
